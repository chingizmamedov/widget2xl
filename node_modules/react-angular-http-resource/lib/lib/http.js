'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _util = require('./util');

var _axios = require('axios');

var _axios2 = _interopRequireDefault(_axios);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var options = {
  defaults: {}
};

var initInterceptors = {
  request: null,
  response: null
};

function HTTP(ignoreOptions) {
  return HTTP.getInstance(ignoreOptions);
}

HTTP.setOptions = function (extendedDefaults) {
  Object.assign(options, extendedDefaults);
  Object.assign(_axios2["default"].defaults, options.defaults);

  if (options.interceptors) {
    var interceptors = options.interceptors;
    if (interceptors.requestSuccess || interceptors.requestError) {
      var request = [];
      request.push(interceptors.requestSuccess || _util.pass);
      request.push(interceptors.requestError || _util.pass);

      if (initInterceptors.request) {
        _axios2["default"].interceptors.request.eject(initInterceptors.request);
        initInterceptors.request = null;
      }

      if (request.length) {
        initInterceptors.request = _axios2["default"].interceptors.request.use.apply(_axios2["default"].interceptors.request, request);
      }
    }

    if (interceptors.responseSuccess || interceptors.responseError) {
      var response = [];
      response.push(interceptors.responseSuccess || _util.pass);
      response.push(interceptors.responseError || _util.pass);

      if (initInterceptors.response) {
        _axios2["default"].interceptors.response.eject(initInterceptors.response);
        initInterceptors.response = null;
      }

      if (response.length) {
        initInterceptors.response = _axios2["default"].interceptors.response.use.apply(_axios2["default"].interceptors.response, response);
      }
    }
  }
};

HTTP.getOptions = function () {
  return options;
};

HTTP.getInstance = function (ignoreOptions) {
  return _axios2["default"];
};

exports["default"] = HTTP;